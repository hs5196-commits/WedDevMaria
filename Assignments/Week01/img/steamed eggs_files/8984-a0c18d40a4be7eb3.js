!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o=(new e.Error).stack;o&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[o]="a7a44842-1196-4138-bba2-82caabfafac0",e._sentryDebugIdIdentifier="sentry-dbid-a7a44842-1196-4138-bba2-82caabfafac0")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8984],{58984:function(e,o,a){a.d(o,{I:function(){return p}});var t=a(65122),r=a(69762),l=a(43186),n=a(52983),i=a(33961),_=a(51986);let s=(e,o)=>{let a=d(e,o),t=u(e);if(!a)throw Error("There are no download parameters for ".concat(e.name," in ").concat(o));return{action:a,modifier:t}},d=(e,o)=>{var a;let t=null===(a=c[e.name])||void 0===a?void 0:a[o];if(!t)throw Error("There are no download parameters for ".concat(e.name," in ").concat(o));return t},u=e=>{if("workflow"===e.name){let o=w[e.subOption];if(!o)throw Error("There are no download parameters for workflow with ".concat(e.subOption));return o}},c={retouch:{detail:"ai_tool_retouch",postDownload:"ai_tool_retouch_after_download"},expand:{detail:"ai_tool_expand",postDownload:"ai_tool_expand_after_download"},reimagine:{detail:"ai_tool_reimagine",postDownload:"ai_tool_reimagine_after_download"},adjust:{detail:"ai_tool_adjust",postDownload:"ai_tool_adjust_after_download",thumbnail:"ai_tool_adjust_thumbnail"},replacebg:{detail:"ai_tool_replacebg"},video:{detail:"ai_tool_video",postDownload:"ai_tool_video_after_download"},assistant:{detail:"ai_tool_assistant",thumbnail:"ai_tool_assistant_thumbnail"},generatePrompt:{detail:"ai_tool_generate_prompt"},styleReference:{detail:"ai_tool_generate_style_ref",postDownload:"ai_tool_generate_style_ref_after_download",thumbnail:"ai_tool_generate_style_ref_thumbnail"},workflow:{detail:"ai_tool_assistant"},imageEditor:{thumbnail:"ai_tool_all_thumbnail",detail:"ai_tool_all",postDownload:"ai_tool_all_after_download"},useAsReference:{detail:"ai_tool_generate_use_as_reference",thumbnail:"ai_tool_generate_image_ref",postDownload:"ai_tool_generate_image_ref_after_download"}},w={createSocialPost:"workflow_create_post",createPoster:"workflow_create_poster",mixImages:"workflow_mix_images",applyPromo:"workflow_apply_promo",createFlyer:"workflow_create_flyer",createLogoVariations:"workflow_create_logo_variations",localize:"workflow_localize",createLogo:"workflow_create_logo",applyColors:"workflow_apply_colors",replaceText:"workflow_replace_text",removeText:"workflow_remove_text",replaceElement:"workflow_replace_element",addElement:"workflow_add_element"};var f=a(75045);let m=e=>{let{tool:o,location:a,imageSrc:t,resource:r}=e,{id:d,name:u,author:c,premium:w,type:m,isAIGenerated:p,preview:g,url:b}=r,{action:h,modifier:k}=s(o,a),y=(0,_.M)({tool:o,resource:{type:m,subtype:m,authorName:c.name,isPremium:w,isAIGenerated:p}}),{handleDownload:v}=(0,f.i)({resource:{id:d,name:u,author:c,premium:w,regularType:m,isAIGenerated:p,url:b,preview:g,type:m},action:h,modifier:k,showAttributionModal:!1,skipDownloadTracker:!0,location:(0,i.d)({isResourcePremium:w,tool:o,location:a}),checkoutQueryParams:y}),T=(0,l.J)(),D=null!=t?t:g.url;return(0,n.useCallback)(async()=>{let e=await v(D);if(!(null==e?void 0:e.signedUrl))throw Error("Failed to download image");return T(),"".concat(e.signedUrl,"&w=2000&h=2000")},[D,v,T])},p=e=>{let{tool:o,location:a,imageSrc:l,extraParams:n,resource:i}=e,{id:_,premium:s,isAIGenerated:d,type:u,author:{name:c},name:w,preview:{url:f,width:p,height:g}}=i,b=(0,t.e)(),h=m({tool:o,location:a,imageSrc:l,resource:i});return(0,r.F)({tool:o,resource:{id:_,name:w,type:u,authorName:c,isPremium:s,isAIGenerated:d,groupedType:"regular",media:{url:f,width:p,height:g}},canDownloadResource:b||!s,imageSrc:l,getSignedResource:h,location:a,extraParams:n})}},15715:function(e,o,a){a.d(o,{H:function(){return r}});let t=e=>{let{resource:o,file:a,option:t,size:r,action:l,walletId:n,locale:i,modifier:_}=e,s=new URLSearchParams;return s.set("resource","".concat(o)),a&&t?(s.set("file",a),s.set("option","".concat(t))):r&&s.set("size","".concat(r)),l&&s.set("action",l),n&&s.set("walletId",n),s.set("locale",i),_&&s.set("modifier",_),s.toString()},r=async e=>{let o=t(e),a=await fetch("/api/regular/download?".concat(o));return a.ok?{success:!0,data:await a.json()}:429===a.status?{success:!1,data:"DOWNLOAD_LIMIT_REACHED",metadata:"/download-limit"}:401===a.status||403===a.status||405===a.status?{success:!1,data:"AUTHENTICATION_ERROR"}:404===a.status?{success:!1,data:"NOT_FOUND"}:{success:!1,data:"UNKNOWN_ERROR"}}},75045:function(e,o,a){a.d(o,{i:function(){return E}});var t=a(72234),r=a(15880),l=a(68147),n=a(85229),i=a(25983),_=a(59608),s=a(52983),d=a(9036),u=a(35576),c=a(7526);let w=(e,o)=>o||("photo"===e?"jpg":"zip");var f=a(24278);a(97458);let m=(0,s.createContext)(null),p=()=>(0,s.useContext)(m)||{shouldTrackingLog:!0};var g=a(15715),b=a(32509),h=a(72661),k=a(72118),y=a(1850),v=a(64979),T=a(56879);let D=y.z.enum(["download","copy","edit","prompt","preview","remove_background","remove_background_edit","ai_video",v.cm,v.PF,v.p3,v.Kq,v.wK,v.os,v.H$,v.C0,v.u4,v.OI,v.Iu,v.e5,"ai_tool_retouch","ai_tool_retouch_after_download","ai_tool_expand","ai_tool_expand_after_download","ai_tool_reimagine","ai_tool_reimagine_after_download","ai_tool_adjust","ai_tool_adjust_after_download","ai_tool_replacebg","ai_tool_video","ai_tool_video_after_download","ai_tool_assistant","ai_tool_generate_prompt","ai_tool_generate_style_ref","ai_tool_generate_style_ref_after_download","ai_tool_generate_style_ref_thumbnail","ai_tool_adjust_thumbnail","ai_tool_assistant_thumbnail","ai_tool_all_thumbnail","ai_tool_all","ai_tool_generate_image_ref","ai_tool_all_after_download","ai_tool_generate_image_ref_after_download","ai_tool_generate_use_as_reference"]),I=y.z.enum(["workflow_create_post","workflow_create_poster","workflow_mix_images","workflow_apply_promo","workflow_create_flyer","workflow_create_logo_variations","workflow_localize","workflow_create_logo","workflow_apply_colors","workflow_replace_text","workflow_remove_text","workflow_replace_element","workflow_add_element"]);y.z.object({resource:y.z.coerce.number(),file:T.ru.optional(),option:y.z.coerce.number().optional(),size:y.z.coerce.number().optional(),action:D.optional(),modifier:I.optional(),walletId:y.z.string().nullable().optional(),locale:y.z.string()}),y.z.object({data:y.z.object({filename:y.z.string(),url:y.z.string(),prompt:y.z.string().optional(),signed_url:y.z.string().optional()})}).transform(e=>{let{data:o}=e;return o}).transform(e=>{let{signed_url:o,...a}=e;return{...a,signedUrl:o}});let z=y.z.array(y.z.string()),N=new Date(new Date().getTime()+48e4),x=k.Z.withConverter({write:e=>e}),O=e=>{try{let o=x.get(e);if(!o)return[];return z.parse(JSON.parse(o))}catch(e){return[]}},R=()=>{let e=(0,l.I)(),o=(0,h.b)();return(0,s.useCallback)(a=>{if(!e)return;let t="".concat("ck_items_").concat(e),r=O(t),l="".concat(a);if(!r.includes(l)){let e=JSON.stringify([...r,l]);x.set(t,e,{path:"/",domain:o,expires:N})}},[e,o])},E=e=>{let{resource:o,file:a,action:m="download",modifier:h,location:k="resource_detail",option:y,size:v,showAttributionModal:T=!0,handleError:D,checkoutQueryParams:I,skipDownloadTracker:z=!1}=e,{id:N,name:x,author:O,premium:E,regularType:C,isAIGenerated:U,url:j,type:A}=o,[L,H]=(0,s.useState)(!1),{isUserWinback:P,showWinbackModal:F}=(0,n.l)(),{showAttribution:S}=(0,f.tc)(),W=R(),K=(0,b.b)({resource:o,location:k}),M=(0,u.mS)(),{shouldTrackingLog:G}=p(),{showDeviceBlockedModal:J,isDeviceBlocked:q}=(0,r.qx)(),Z=(0,t.Lh)(),$=(0,l.I)(),V=(0,i.ZK)(),B=(0,d.TH)({file_extension:w(C,a),file_name:x,file_id:N,license:E?"premium":"free",resolution:v?c.w8[v]:"original",style:"na",author_name:O.name,category:U?"ai_image":C,action:"prompt"===m?"view_prompt":m,location:k,url_link:j}),Q=(0,s.useCallback)(e=>{if(D){D(e);return}"prompt"!==m&&K(e,I)},[D,m,K,I]);return{handleDownload:(0,s.useCallback)(async(e,o)=>{if(q){J();return}if(P){F();return}H(!0),Z||_.uT("WARNING: User ".concat($," has no wallet_id"),"warning"),G&&!z&&M({resourceId:N,isResourcePremium:E,resourceType:A,downloadType:m,fileType:A,variant:k});let t=await (0,g.H)({resource:N,size:v?2e3:void 0,action:m,modifier:h,file:a,option:y,walletId:Z,locale:V});if(t.success)return T&&S&&S(),H(!1),W(N),B({externalUrl:null!=e?e:j,setting:o}),t.data;Q(t),H(!1)},[q,P,Z,G,z,N,v,m,h,a,y,V,Q,J,F,$,M,E,A,k,T,S,W,B,j]),isDownloading:L}}},32509:function(e,o,a){a.d(o,{b:function(){return i}});var t=a(19170),r=a(10893),l=a(52983),n=a(65724);let i=e=>{var o;let{location:a,resource:i}=null!=e?e:{},{t:_}=(0,r.$G)("error"),{openToast:s}=(0,t.x_)(),d=(0,n.W)(null!==(o=null==i?void 0:i.id)&&void 0!==o?o:0,"",a);return(0,l.useCallback)((e,o)=>{if("DOWNLOAD_LIMIT_REACHED"===e.data&&i){d({resourceData:{name:i.name,mediaUrl:i.preview.url,mediaWidth:i.preview.width,mediaHeight:i.preview.height,resourceType:"regular"},checkoutQueryParams:o,modalType:"downloadLimit",origin:"download_limit"});return}if("AUTHENTICATION_ERROR"===e.data){window.location.href="/oauth-logout";return}"NOT_FOUND"===e.data&&s({type:"danger",message:_("notFound")}),"UNKNOWN_ERROR"===e.data&&s({type:"danger",message:_("unknown")})},[d,s,i,_])}}}]);